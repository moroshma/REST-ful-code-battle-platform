Саморасшифровавшаяся шифровка

  -----------------------------------------------------------------------
  Имя входного файла:                                f.in
  -------------------------------------------------- --------------------
  Имя выходного файла:                               f.out

  Максимальное время работы на одном тесте:          1 секунда

  Максимальный объем используемой памяти:            64 мегабайта

                                                     
  -----------------------------------------------------------------------

Петя решил зашифровать свой дневник, чтобы никто без его ведома не смог
его прочитать. Для этого он воспользовался следующим шифром.

Он изготовил трафарет *N*x*N* клеток (*N* --- четное), в котором вырезал
N^2^ /4 клеток так, что при наложении трафарета на лист бумаги четырьмя
возможными способами (трафарет можно поворачивать, но нельзя
переворачивать) каждая клетка листа видна ровно один раз.

С помощью этого трафарета шифруется текст из *N*^2^ символов следующим
образом. Сначала в прорези трафарета вписываются первые N^2^ /4 букв
шифруемого текста (буквы вписываются в вырезанные клетки по строкам
сверху вниз, в каждой строке --- слева направо).

Далее трафарет поворачивается на 90 градусов по часовой стрелке, и в
вырезанные клетки в том же порядке вписываются следующие N^2^ /4 букв
шифруемого текста. И так далее. Если шифруемый текст состоит меньше, чем
из *N*^2^ символов, то (когда текст кончается) оставшиеся клетки
остаются пустыми.

Для повышения надежности Петя решил зашифрованный текст зашифровать тем
же методом с помощью того же трафарета еще раз, затем получившийся текст
--- еще раз и т.д. После нескольких повторов Петя с удивлением заметил,
что зашифрованный текст совпал с исходным.

Напишите программу, которая для данного трафарета определит, после
какого наименьшего количества процедур шифрования Петя получит исходный
текст независимо от содержания текста?

Формат входных данных

Сначала во входном файле записано число *N* --- размер трафарета
(2≤*N*≤150). Затем идет *N*^2^ чисел (каждое из которых 0 или 1),
описывающих трафарет. 1 обозначает вырезанную клетку, 0 --- не
вырезанную. Гарантируется, что данная последовательность описывает
корректный трафарет для данного способа шифрования.

Формат выходных данных

В выходной файл выведите одно число --- через какое минимальное
количество повторов операции шифрования Петя получит исходный текст
независимо от его содержания.

Примеры

+-----------------------------------+-----------------------------------+
| f.in                              | f.out                             |
+===================================+===================================+
| 2                                 | 2                                 |
|                                   |                                   |
| 1 0                               |                                   |
|                                   |                                   |
| 0 0                               |                                   |
+-----------------------------------+-----------------------------------+
| 6                                 | 120                               |
|                                   |                                   |
| 1 0 0 0 1 0                       |                                   |
|                                   |                                   |
| 0 1 0 1 0 0                       |                                   |
|                                   |                                   |
| 0 0 0 0 1 0                       |                                   |
|                                   |                                   |
| 0 0 1 0 0 1                       |                                   |
|                                   |                                   |
| 1 0 0 0 0 0                       |                                   |
|                                   |                                   |
| 0 0 0 1 0 0                       |                                   |
+-----------------------------------+-----------------------------------+
